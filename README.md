# FileService_Test

## Возможности сервиса

Данный сервис является тестовым заданием и используется для работы с файлами. Он представлен в виде Web API и на данный момент использует Swagger для работы с методами.

Для работы с пользователями есть три метода:

* /RegisterUser. Регистрация пользователя при вводе имени пользователя и пароля;
* /Login. Для входа пользователя в сервис при помощи ввода имени пользователя и пароля (без входа недоступна большая часть функционала по работе с файлами);
* /Logout. Выход пользователя

Для работы с файлами, как и было написано выше необходимо сначала зайти через Login. Для файлов существует 10 методов:

* /UploadFiles. Загрузка файлов на сервер с указанием имени группы (имя группы не должно совпадать);
* /GetGroupUploadFilePercentage. Получение процента загрузки файлов на сервер внутри конкретной группы по её id;
* /GetUploadFilePercentage. Получение процента загрузки конкретного файла на сервер по его id;
* /GetAllUploadedFileGroups. Получение списка всех групп, загруженных данным пользователем;
* /GetAllUploadedFiles. Получение списка всех файлов, загруженных данным пользователем;
* /DownloadFile. Скачивание конкретного файла по его id;
* /DownloadFileGroup. Скачивание группы файлов в виде архива .zip по id группы;
* /DownloadViaLink. Метод для скачивания файлов по сгенерированной ссылке. Здесь нужно уточнить, что данные метод внутри самого Swagger принимает именно данные о типе скачиваемого объекта (файл или группа) и секрета, который ссылается на то, что нужно скачать. Именно его можно не использовать. Можно сразу в браузере вбить полученную ссылку из двух следующих методов;
* /GenerateFileDownloadLink. Генерация одноразовой ссылки для скачивания файла;
* /GenerateFileGroupDownloadLink. Генерация одноразовой ссылки для скачивания группы файлов.

## Что использовалось

ASP.NET для написания сервиса, VS 2022 для написания кода на c#, SQL Server как хранилище БД, Swagger для работы c API, EF Core для работы с базой данных, EFCore.Tools для создания миграций и БД.

## Как развернуть у себя

Скачать данный репозиторий и расположить его в удобном месте. Проверить скачан ли SQL Server, если нет, то скачать. Для установки можно воспользоваться данным [гайдом](https://learn.microsoft.com/ru-ru/sql/database-engine/install-windows/install-sql-server-from-the-installation-wizard-setup?view=sql-server-ver16).

После необходимо создать саму базу данных на основе миграций в репозитории. Для этого необоходимо перейти в сам репозиторий в командной строке и выполнить следующую комманду:

* `dotnet ef database update`

Если же у вас не установлены tools для dotnet, то через следующие команды это можно исправить:

* Установка tools `dotnet tool install --global dotnet-ef`
* Обновление tools `dotnet tool update --global dotnet-ef`

После всего этого, можно проверить опять же в СУБД для SQL Server, что база создана. Дальше необходимо уже собрать сам проект и запутить его. Для этого:

* Убедится, что установлен dotnet через `dotnet --version`, если нет, то воспользоваться следующим [гайдом](https://learn.microsoft.com/ru-ru/dotnet/core/install/windows?tabs=net70). Желательно устанавливать последнюю версию;
* Перейти в командной строке к папке, где хранится .csproj элемент сервиса (по идее из самой папки преокта нужно перейти по команде `cd FileService_Test`);
* Собрать проект через `dotnet build`;
* Запустить проект через dotnet run `--launch-profile https`;
* Есть шанс, что могут возникнуть проблемы с сертификатом, в таком слечае необходимо ввести комманду `dotnet dev-certs https --trust`;
* После запуска проекта в консоли отобразится информация о том, что он запущен и на каком адресе. Для того, чтобы открыть Swagger необходимо открыть браузер и ввести в адресную строку `https://localhost:7247/swagger/index.html`;
* Если всё было правильно сделано, то в браузере отбразится форма со Swagger.
